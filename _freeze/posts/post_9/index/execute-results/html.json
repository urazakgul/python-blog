{
  "hash": "22ae5b76fe70347455af8ee27aae8fb4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"TCMB/EVDS Verilerine Erişim (05/04/2024 Değişikliği Sonrası)\"\nauthor: \"Uraz Akgül\"\ndate: \"2024-04-21\"\ndate-modified: last-modified\ndate-format: \"MMMM D, YYYY\"\ncategories: [API, EVDS]\nimage: \"imgs/evds.PNG\"\nexecute:\n  eval: false\n---\n\nTürkiye Cumhuriyet Merkez Bankası, *yenievds@tcmb.gov.tr* adresinden bir duyuru göndermişti. Mail almayanlar için bir kısmını aşağıda paylaşıyorum.\n\n*Önceki duyurumuzda EVDS nin web servis parametrelerinde güvenlik sebebiyle bir düzenleme yapılacağını belirtmiştik. URL adresinden giden \"key\" parametresinin artık http request header içinde gelmesi ve web servis kullanan uygulamalarınızda \"key=xxxxxx\" parametresini http request header olarak dönüştürmeniz gerektiği belirtilmişti. Bu düzenleme 05 Nisan 2024 Cuma saat 21:00 TSİ tarihinden itibaren geçerli olacaktır.*\n\nURL adresinden gönderdiğimiz `key` parametresini artık `headers` içinden göndereceğiz.\n\n::: {#14f3e210 .cell execution_count=1}\n``` {.python .cell-code}\nimport requests\nimport json\nfrom urllib.parse import urlencode\nimport pandas as pd\n\napi_key = 'api_key'\n\nseries_code='TP.APIFON4' # TCMB Ağırlıklı Ortalama Fonlama Maliyeti\nstart_date='01-01-2011' # Başlangıç\nend_date='30-04-2024' # Bitiş\nfrequency='5' # Aylık\naggregationType='avg' # Ortalama\n\nparams = {\n    'series': series_code,\n    'startDate': start_date,\n    'endDate': end_date,\n    'frequency': frequency,\n    'aggregationTypes': aggregationType,\n    'type': 'json'\n}\n\nurl = f'https://evds2.tcmb.gov.tr/service/evds/{urlencode(params)}'\n\nresponse = requests.get(url=url, headers={'key': api_key})\n\n# print(response.request.headers)\n\nformatted_response = json.loads(response.content)\n\ndata = formatted_response['items']\ndf = pd.DataFrame(data)\n\ndf['Tarih'] = pd.to_datetime(df['Tarih']) + pd.offsets.Day(0)\ndf = df.drop(columns=['UNIXTIME'])\ndf.columns = ['Tarih', 'AOFM']\ndf['AOFM'] = pd.to_numeric(df['AOFM'])\n```\n:::\n\n\nEğer birden fazla seri ile çalışmak istiyorsak, seriler arasında `-` olacak şekilde giriş yapacağız.\n\n::: {#aa4fe716 .cell execution_count=2}\n``` {.python .cell-code}\nseries_code='TP.BISTTLREF.DUSUK-TP.BISTTLREF.YUKSEK-TP.BISTTLREF.KAPANIS' # Türk Lirası Gecelik Referans Faiz Oranı\nstart_date='14-06-2019' # Başlangıç\nend_date='30-04-2024' # Bitiş\nfrequency='5' # Aylık\n\nparams = {\n    'series': series_code,\n    'startDate': start_date,\n    'endDate': end_date,\n    'frequency': frequency,\n    'type': 'json'\n}\n\nurl = f'https://evds2.tcmb.gov.tr/service/evds/{urlencode(params)}'\n\nresponse = requests.get(url=url, headers={'key': api_key})\n\n# print(response.request.headers)\n\nformatted_response = json.loads(response.content)\n\ndata = formatted_response['items']\ndf = pd.DataFrame(data)\n\ndf['Tarih'] = pd.to_datetime(df['Tarih']) + pd.offsets.Day(0)\ndf = df.drop(columns=['UNIXTIME'])\nnumeric_columns = df.columns[df.columns != 'Tarih']\ndf[numeric_columns] = df[numeric_columns].apply(pd.to_numeric)\n```\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}