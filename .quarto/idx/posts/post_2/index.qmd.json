{"title":"Korelasyon Tahmin Oyunu","markdown":{"yaml":{"title":"Korelasyon Tahmin Oyunu","author":"Uraz Akgül","date":"2024-03-24","date-format":"MMMM D, YYYY","categories":["Oyun","Web Uygulaması"],"execute":{"eval":false}},"headingText":"print(f'Randomly selected correlation: {rho}')","containsRefs":false,"markdown":"\n\nKorelasyon tahmin oyunu yapımında nelere ihtiyacımız olabilir?\n\nBirincisi, iki adet rassal seri üretmeliyiz ve bu serileri üretirken korelasyon katsayısını dikkate almalıyız. Buradaki korelasyon katsayısı Pearson'ı ifade etmektedir. Rassal serileri üretmek için `numpy` kütüphanesinin `np.random.multivariate_normal` fonksiyonundan faydalanabiliriz.\n\nİkincisi, kullanıcı için bir skorlama yapmalıyız. Bunun için RMSE (Root Mean Squared Error, Kök Ortalama Kare Hatası) metriğini kullanabiliriz. RMSE skoru düştükçe başarı artacaktır.\n\nÜçüncüsü, kullanıcı ile etkileşimde olmalıyız. Etkileşim için Streamlit ile bir web uygulaması yapabiliriz. Uygulamayı lokalde çalıştıracağız.\n\n**Kullanılacak Kütüphaneler**\n\n```{python}\n\nimport streamlit as st\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n```\n\n**Korelasyonlu Rassal Serilerin Üretilmesi**\n\n```{python}\n\ndef generate_correlated_data():\n    num_points = int(np.random.uniform(low=100, high=1000))\n    rho = round(np.random.uniform(low=-1, high=1), 2)\n    cov_matrix = np.array([[1, rho], [rho, 1]])\n    mu = [0, 0]\n    correlated_data = np.random.multivariate_normal(mean=mu, cov=cov_matrix, size=num_points)\n    return correlated_data, rho\n\n```\n\nFonksiyonumuzun ismini `generate_correlated_data` olarak belirledik ve fonksiyonumuzun herhangi bir parametresi bulunmamaktadır.\n\n`num_points` değişkeni, 100 ile 1000 arasında olmak üzere rassal olarak üretilecek serilere ait verilerin uzunluğunu temsil etmektedir. Bu değeri üretebilmek için `numpy` kütüphanesinin `np.random.uniform` fonksiyonunu kullandık ve `int()` ile değerin tam sayı veri tipinde olmasını sağladık.\n\n`rho` değişkeni, -1 ile 1 arasında rassal olarak olarak üretilmiş bir korelasyon katsayısını temsil etmektedir. Bu değeri üretebilmek için `np.random.uniform` fonksiyonunu kullandık. `rho` değerini noktadan sonra iki rakam gelecek şekilde ayarladık.\n\n`cov_matrix` değişkeni, 2x2'lik bir kovaryans matrisini temsil etmektedir.\n\n`mu` değişkeni, veri kümesinin her bir boyutu için belirlenen ortalama değeri temsil etmektedir. Bu değer 0 olacağı için X ve Y `[0, 0]`'dır.\n\n`correlated_data` değişkeni, `np.random.multivariate_normal` fonksiyonu yardımıyla üretilen verileri temsil etmektedir. Bu fonksiyon, çok değişkenli bir normal dağılımdan rassal örnekler üretir. Fonksiyonun içerisine parametre olarak ortalama, kovaryans matrisi ve örnek büyüklüğü girilir.\n\n`generate_correlated_data` fonksiyonu bize `correlated_data` ve `rho` değerlerini dönüyor. `correlated_data` değişkenindeki ilk seriye `correlated_data[:,0]`; ikinci seriye `correlated_data[:,1]` ile ulaşılabilir.\n\nFonksiyonun döndüğü değerleri kullanarak bir görselleştirme yapalım.\n\n```{python}\n\ncorrelated_data, rho = generate_correlated_data()\n\n\nplt.figure(figsize=(8, 6))\nplt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\nplt.title('Scatter Plot of Correlated Data')\nplt.xlabel('X')\nplt.ylabel('Y')\nplt.grid(True)\nplt.show()\n\n```\n\n![](imgs/img_1.png)\n\nBir diğer fonksiyonumuz olan ve RMSE değerini hesaplayan `calculate_rmse` fonksiyonuna bakalım.\n\n$\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}$\n\n```{python}\n\ndef calculate_rmse(predictions, actuals):\n    mse = np.mean((predictions - actuals) ** 2)\n    rmse = round(np.sqrt(mse), 4)\n    return rmse\n\n```\n\n`calculate_rmse` fonksiyonu, `predictions` ve `actuals` olmak üzere 2 adet parametre alıyor. Önce `mse` değişkenine tahminler ile gerçek değerler arasındaki farkların karelerinin ortalamasını gönderiyoruz. Ardından da bu ortalamanın karekökünü `rmse` değişkenine atıyoruz ve bu değeri noktadan sonra 4 rakam olacak şekilde döndürüyoruz.\n\nKodların ana yapısını oluşturduk.\n\n**Streamlit Web Uygulamasının Yapımı**\n\nWeb uygulaması tarafında kullanılan kodlar aşağıdadır.\n\n```{python}\n\n# Oturum durumu değişkenlerinin tanımlanması ve varsayılan değerlerin ayarlanması\nst.session_state.setdefault('rhos', []) # Korelasyon katsayıları\nst.session_state.setdefault('guesses', []) # Kullanıcının tahminleri\nst.session_state.setdefault('rmse_values', []) # RMSE değeri\nst.session_state.setdefault('plots', []) # Görseller\n\n# Korelasyonlu veri oluşturan fonksiyon\ndef generate_correlated_data():\n    num_points = int(np.random.uniform(low=100, high=1000))\n    rho = round(np.random.uniform(low=-1, high=1), 2)\n    cov_matrix = np.array([[1, rho], [rho, 1]])\n    mu = [0, 0]\n    correlated_data = np.random.multivariate_normal(mean=mu, cov=cov_matrix, size=num_points)\n    return correlated_data, rho\n\n# RMSE hesaplayan fonksiyon\ndef calculate_rmse(predictions, actuals):\n    mse = np.mean((predictions - actuals) ** 2)\n    rmse = round(np.sqrt(mse), 4)\n    return rmse\n\n# 'rhos' listesi boş ise yeni bir korelasyonlu veri oluşturulması ve korelasyon katsayısının kaydedilmesi\nif len(st.session_state['rhos']) == 0:\n    correlated_data, rho = generate_correlated_data()\n    st.session_state['rhos'].append(rho)\n\n# 'plots' listesi boşsa ilk görselin oluşturulması ve kaydedilmesi\nif len(st.session_state['plots']) == 0:\n    plt.figure(figsize=(8, 6))\n    plt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\n    plt.title('Scatter Plot of Correlated Data')\n    plt.xlabel('X')\n    plt.ylabel('Y')\n    plt.grid(True)\n    st.session_state['plots'].append(plt)\n    st.pyplot(st.session_state['plots'][0])\n\n# Kullanıcının tahmini\nuser_guess = st.sidebar.text_input(\n    label='Your Guess:',\n    value='0.0'\n)\n\n# Kullanıcı tahmininin ondalık sayıya dönüştürülmesi\nuser_guess = float(user_guess)\n\n# Tahmin butonunun oluşturulması\nguess_button = st.sidebar.button(label='Guess')\n\n# Tahmin butonuna basıldığında yapılacaklar\nif guess_button:\n    correlated_data, rho = generate_correlated_data()\n    st.session_state['rhos'].append(rho)\n    st.session_state['guesses'].append(user_guess)\n    rmse = calculate_rmse(np.array(st.session_state['rhos'][:-1]), np.array(st.session_state['guesses']))\n    st.session_state['rmse_values'].append(rmse)\n\n    st.subheader(f'Guess: {st.session_state[\"guesses\"][-1]}, Actual: {st.session_state[\"rhos\"][-2]}, RMSE: {st.session_state[\"rmse_values\"][-1]}')\n\n    plt.figure(figsize=(8, 6))\n    plt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\n    plt.title('Scatter Plot of Correlated Data')\n    plt.xlabel('X')\n    plt.ylabel('Y')\n    plt.grid(True)\n    st.session_state['plots'].append(plt)\n    st.pyplot(st.session_state['plots'][-1])\n\n```\n\nWindows/Visual Studio Code için bir not: Streamlit uygulamasının yapımında kullanılacak olan kodları `.py` uzantılı `app.py` isminde bir script'e kaydedip terminalden `streamlit run app.py` komutu ile çalıştırabilirsiniz.\n\n*Gelecek içeriklerde görüşmek dileğiyle.*","srcMarkdownNoYaml":"\n\nKorelasyon tahmin oyunu yapımında nelere ihtiyacımız olabilir?\n\nBirincisi, iki adet rassal seri üretmeliyiz ve bu serileri üretirken korelasyon katsayısını dikkate almalıyız. Buradaki korelasyon katsayısı Pearson'ı ifade etmektedir. Rassal serileri üretmek için `numpy` kütüphanesinin `np.random.multivariate_normal` fonksiyonundan faydalanabiliriz.\n\nİkincisi, kullanıcı için bir skorlama yapmalıyız. Bunun için RMSE (Root Mean Squared Error, Kök Ortalama Kare Hatası) metriğini kullanabiliriz. RMSE skoru düştükçe başarı artacaktır.\n\nÜçüncüsü, kullanıcı ile etkileşimde olmalıyız. Etkileşim için Streamlit ile bir web uygulaması yapabiliriz. Uygulamayı lokalde çalıştıracağız.\n\n**Kullanılacak Kütüphaneler**\n\n```{python}\n\nimport streamlit as st\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n```\n\n**Korelasyonlu Rassal Serilerin Üretilmesi**\n\n```{python}\n\ndef generate_correlated_data():\n    num_points = int(np.random.uniform(low=100, high=1000))\n    rho = round(np.random.uniform(low=-1, high=1), 2)\n    cov_matrix = np.array([[1, rho], [rho, 1]])\n    mu = [0, 0]\n    correlated_data = np.random.multivariate_normal(mean=mu, cov=cov_matrix, size=num_points)\n    return correlated_data, rho\n\n```\n\nFonksiyonumuzun ismini `generate_correlated_data` olarak belirledik ve fonksiyonumuzun herhangi bir parametresi bulunmamaktadır.\n\n`num_points` değişkeni, 100 ile 1000 arasında olmak üzere rassal olarak üretilecek serilere ait verilerin uzunluğunu temsil etmektedir. Bu değeri üretebilmek için `numpy` kütüphanesinin `np.random.uniform` fonksiyonunu kullandık ve `int()` ile değerin tam sayı veri tipinde olmasını sağladık.\n\n`rho` değişkeni, -1 ile 1 arasında rassal olarak olarak üretilmiş bir korelasyon katsayısını temsil etmektedir. Bu değeri üretebilmek için `np.random.uniform` fonksiyonunu kullandık. `rho` değerini noktadan sonra iki rakam gelecek şekilde ayarladık.\n\n`cov_matrix` değişkeni, 2x2'lik bir kovaryans matrisini temsil etmektedir.\n\n`mu` değişkeni, veri kümesinin her bir boyutu için belirlenen ortalama değeri temsil etmektedir. Bu değer 0 olacağı için X ve Y `[0, 0]`'dır.\n\n`correlated_data` değişkeni, `np.random.multivariate_normal` fonksiyonu yardımıyla üretilen verileri temsil etmektedir. Bu fonksiyon, çok değişkenli bir normal dağılımdan rassal örnekler üretir. Fonksiyonun içerisine parametre olarak ortalama, kovaryans matrisi ve örnek büyüklüğü girilir.\n\n`generate_correlated_data` fonksiyonu bize `correlated_data` ve `rho` değerlerini dönüyor. `correlated_data` değişkenindeki ilk seriye `correlated_data[:,0]`; ikinci seriye `correlated_data[:,1]` ile ulaşılabilir.\n\nFonksiyonun döndüğü değerleri kullanarak bir görselleştirme yapalım.\n\n```{python}\n\ncorrelated_data, rho = generate_correlated_data()\n\n# print(f'Randomly selected correlation: {rho}')\n\nplt.figure(figsize=(8, 6))\nplt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\nplt.title('Scatter Plot of Correlated Data')\nplt.xlabel('X')\nplt.ylabel('Y')\nplt.grid(True)\nplt.show()\n\n```\n\n![](imgs/img_1.png)\n\nBir diğer fonksiyonumuz olan ve RMSE değerini hesaplayan `calculate_rmse` fonksiyonuna bakalım.\n\n$\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}$\n\n```{python}\n\ndef calculate_rmse(predictions, actuals):\n    mse = np.mean((predictions - actuals) ** 2)\n    rmse = round(np.sqrt(mse), 4)\n    return rmse\n\n```\n\n`calculate_rmse` fonksiyonu, `predictions` ve `actuals` olmak üzere 2 adet parametre alıyor. Önce `mse` değişkenine tahminler ile gerçek değerler arasındaki farkların karelerinin ortalamasını gönderiyoruz. Ardından da bu ortalamanın karekökünü `rmse` değişkenine atıyoruz ve bu değeri noktadan sonra 4 rakam olacak şekilde döndürüyoruz.\n\nKodların ana yapısını oluşturduk.\n\n**Streamlit Web Uygulamasının Yapımı**\n\nWeb uygulaması tarafında kullanılan kodlar aşağıdadır.\n\n```{python}\n\n# Oturum durumu değişkenlerinin tanımlanması ve varsayılan değerlerin ayarlanması\nst.session_state.setdefault('rhos', []) # Korelasyon katsayıları\nst.session_state.setdefault('guesses', []) # Kullanıcının tahminleri\nst.session_state.setdefault('rmse_values', []) # RMSE değeri\nst.session_state.setdefault('plots', []) # Görseller\n\n# Korelasyonlu veri oluşturan fonksiyon\ndef generate_correlated_data():\n    num_points = int(np.random.uniform(low=100, high=1000))\n    rho = round(np.random.uniform(low=-1, high=1), 2)\n    cov_matrix = np.array([[1, rho], [rho, 1]])\n    mu = [0, 0]\n    correlated_data = np.random.multivariate_normal(mean=mu, cov=cov_matrix, size=num_points)\n    return correlated_data, rho\n\n# RMSE hesaplayan fonksiyon\ndef calculate_rmse(predictions, actuals):\n    mse = np.mean((predictions - actuals) ** 2)\n    rmse = round(np.sqrt(mse), 4)\n    return rmse\n\n# 'rhos' listesi boş ise yeni bir korelasyonlu veri oluşturulması ve korelasyon katsayısının kaydedilmesi\nif len(st.session_state['rhos']) == 0:\n    correlated_data, rho = generate_correlated_data()\n    st.session_state['rhos'].append(rho)\n\n# 'plots' listesi boşsa ilk görselin oluşturulması ve kaydedilmesi\nif len(st.session_state['plots']) == 0:\n    plt.figure(figsize=(8, 6))\n    plt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\n    plt.title('Scatter Plot of Correlated Data')\n    plt.xlabel('X')\n    plt.ylabel('Y')\n    plt.grid(True)\n    st.session_state['plots'].append(plt)\n    st.pyplot(st.session_state['plots'][0])\n\n# Kullanıcının tahmini\nuser_guess = st.sidebar.text_input(\n    label='Your Guess:',\n    value='0.0'\n)\n\n# Kullanıcı tahmininin ondalık sayıya dönüştürülmesi\nuser_guess = float(user_guess)\n\n# Tahmin butonunun oluşturulması\nguess_button = st.sidebar.button(label='Guess')\n\n# Tahmin butonuna basıldığında yapılacaklar\nif guess_button:\n    correlated_data, rho = generate_correlated_data()\n    st.session_state['rhos'].append(rho)\n    st.session_state['guesses'].append(user_guess)\n    rmse = calculate_rmse(np.array(st.session_state['rhos'][:-1]), np.array(st.session_state['guesses']))\n    st.session_state['rmse_values'].append(rmse)\n\n    st.subheader(f'Guess: {st.session_state[\"guesses\"][-1]}, Actual: {st.session_state[\"rhos\"][-2]}, RMSE: {st.session_state[\"rmse_values\"][-1]}')\n\n    plt.figure(figsize=(8, 6))\n    plt.scatter(correlated_data[:,0], correlated_data[:,1], alpha=0.7)\n    plt.title('Scatter Plot of Correlated Data')\n    plt.xlabel('X')\n    plt.ylabel('Y')\n    plt.grid(True)\n    st.session_state['plots'].append(plt)\n    st.pyplot(st.session_state['plots'][-1])\n\n```\n\nWindows/Visual Studio Code için bir not: Streamlit uygulamasının yapımında kullanılacak olan kodları `.py` uzantılı `app.py` isminde bir script'e kaydedip terminalden `streamlit run app.py` komutu ile çalıştırabilirsiniz.\n\n*Gelecek içeriklerde görüşmek dileğiyle.*"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Içindekiler","toc-title-website":"Bu sayfada","related-formats-title":"Diğer Formatlar","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Kaynak","other-links-title":"Diğer Bağlantılar","code-links-title":"Kod Bağlantıları","launch-dev-container-title":"Dev Container Başlat","launch-binder-title":"Binder Başlat","article-notebook-label":"Makale Defteri","notebook-preview-download":"Defteri İndir","notebook-preview-download-src":"Kaynak kodunu indir","notebook-preview-back":"Makaleye Geri Dön","manuscript-meca-bundle":"MECA Arşivi","section-title-abstract":"Özet","section-title-appendices":"Ekler","section-title-footnotes":"Dipnotlar","section-title-references":"Referanslar","section-title-reuse":"Yeniden kullanın","section-title-copyright":"Telif hakkı","section-title-citation":"Alıntı","appendix-attribution-cite-as":"Lütfen bu çalışmayı şu şekilde alıntılayın:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Yazar","title-block-author-plural":"Yazarlar","title-block-affiliation-single":"üyelik","title-block-affiliation-plural":"Bağlantılar","title-block-published":"Yayınlanma Tarihi","title-block-modified":"Değiştirilmiş","title-block-keywords":"Anahtar kelimeler","callout-tip-title":"Tavsiye","callout-note-title":"Not","callout-warning-title":"Uyarı","callout-important-title":"Önemli","callout-caution-title":"Dikkat","code-summary":"Kod","code-tools-menu-caption":"Kod","code-tools-show-all-code":"Tüm Kodu Göster","code-tools-hide-all-code":"Tüm Kodu Gizle","code-tools-view-source":"Kaynağı Görüntüle","code-tools-source-code":"Kaynak Kodu","tools-share":"Share","tools-download":"Download","code-line":"Satiri","code-lines":"Satırlar","copy-button-tooltip":"Panoya Kopyala","copy-button-tooltip-success":"Kopyalandı","repo-action-links-edit":"Bu sayfayı düzenle","repo-action-links-source":"Kaynağı görüntüle","repo-action-links-issue":"Sorun bildir","back-to-top":"Başa dönüş","search-no-results-text":"Sonuç yok","search-matching-documents-text":"eşleşen belgeler","search-copy-link-title":"Aramak için bağlantıyı kopyalayın","search-hide-matches-text":"Ek eşleşmeleri gizle","search-more-match-text":"bu belgede daha fazla eşleşme","search-more-matches-text":"bu belgede daha fazla eşleşmeler","search-clear-button-title":"Temizle","search-text-placeholder":"","search-detached-cancel-button-title":"İptal et","search-submit-button-title":"Göndermek","search-label":"Aramak","toggle-section":"Bölümü değiştir","toggle-sidebar":"Kenar çubuğunu değiştir","toggle-dark-mode":"Karanlık modu değiştir","toggle-reader-mode":"Okuyucu modunu değiştir","toggle-navigation":"Gezinmeyi değiştir","crossref-fig-title":"Figür","crossref-tbl-title":"Tablo","crossref-lst-title":"Listeleme","crossref-thm-title":"Teorem","crossref-lem-title":"Yardımcı Teorem","crossref-cor-title":"Doğal Sonuç","crossref-prp-title":"Önerme","crossref-cnj-title":"Varsayım","crossref-def-title":"Tanım","crossref-exm-title":"Örnek","crossref-exr-title":"Egzersiz","crossref-ch-prefix":"Bölüm","crossref-apx-prefix":"Ek","crossref-sec-prefix":"Bölüm","crossref-eq-prefix":"Denklem","crossref-lof-title":"Şekil Listesi","crossref-lot-title":"Tablo Listesi","crossref-lol-title":"İlan Listesi","environment-proof-title":"Kanıt","environment-remark-title":"Yorum","environment-solution-title":"Çözüm","listing-page-order-by":"Sıralama Öğesi","listing-page-order-by-default":"Varsayılan","listing-page-order-by-date-asc":"En eski","listing-page-order-by-date-desc":"En yeni","listing-page-order-by-number-desc":"Yüksekten Alçağa","listing-page-order-by-number-asc":"Alcaktan Yükseğe","listing-page-field-date":"Tarih","listing-page-field-title":"Başlık","listing-page-field-description":"Açıklama","listing-page-field-author":"Yazar","listing-page-field-filename":"Dosya adı","listing-page-field-filemodified":"Değiştirilmiş","listing-page-field-subtitle":"Alt yazı","listing-page-field-readingtime":"Okuma zamanı","listing-page-field-wordcount":"Kelime Sayımı","listing-page-field-categories":"Kategoriler","listing-page-minutes-compact":"{0} dakika","listing-page-category-all":"Hepsi","listing-page-no-matches":"Eşleşen öğe yok","listing-page-words":"{0} kelime"},"metadata":{"lang":"tr","fig-responsive":true,"quarto-version":"1.4.551","date-format":"MMMM D, YYYY","theme":{"light":"litera","dark":"solar"},"title-block-banner":true,"title":"Korelasyon Tahmin Oyunu","author":"Uraz Akgül","date":"2024-03-24","categories":["Oyun","Web Uygulaması"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}